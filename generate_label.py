import numpy as np
import cv2

from utils import label as label_utils
from utils import image as img_utils


if __name__ == '__main__':
    points = np.array([
        [300, 100],
        [
            63,
            16
        ],
        [
            58,
            21
        ],
        [
            58,
            22
        ],
        [
            57,
            23
        ],
        [
            57,
            24
        ],
        [
            56,
            25
        ],
        [
            56,
            26
        ],
        [
            55,
            27
        ],
        [
            55,
            30
        ],
        [
            54,
            31
        ],
        [
            54,
            33
        ],
        [
            53,
            34
        ],
        [
            53,
            53
        ],
        [
            54,
            54
        ],
        [
            54,
            60
        ],
        [
            55,
            61
        ],
        [
            55,
            74
        ],
        [
            54,
            75
        ],
        [
            54,
            85
        ],
        [
            53,
            86
        ],
        [
            53,
            91
        ],
        [
            54,
            92
        ],
        [
            54,
            95
        ],
        [
            56,
            97
        ],
        [
            57,
            97
        ],
        [
            63,
            103
        ],
        [
            63,
            109
        ],
        [
            64,
            110
        ],
        [
            64,
            120
        ],
        [
            65,
            121
        ],
        [
            65,
            125
        ],
        [
            66,
            126
        ],
        [
            66,
            128
        ],
        [
            67,
            129
        ],
        [
            67,
            130
        ],
        [
            69,
            132
        ],
        [
            69,
            133
        ],
        [
            74,
            138
        ],
        [
            74,
            139
        ],
        [
            75,
            140
        ],
        [
            75,
            141
        ],
        [
            77,
            143
        ],
        [
            77,
            144
        ],
        [
            78,
            145
        ],
        [
            78,
            146
        ],
        [
            79,
            147
        ],
        [
            79,
            148
        ],
        [
            80,
            149
        ],
        [
            80,
            158
        ],
        [
            81,
            159
        ],
        [
            81,
            161
        ],
        [
            83,
            163
        ],
        [
            84,
            163
        ],
        [
            85,
            164
        ],
        [
            85,
            165
        ],
        [
            86,
            166
        ],
        [
            87,
            166
        ],
        [
            88,
            167
        ],
        [
            93,
            167
        ],
        [
            93,
            166
        ],
        [
            94,
            165
        ],
        [
            94,
            164
        ],
        [
            95,
            163
        ],
        [
            95,
            162
        ],
        [
            96,
            161
        ],
        [
            96,
            157
        ],
        [
            97,
            156
        ],
        [
            97,
            151
        ],
        [
            96,
            150
        ],
        [
            96,
            147
        ],
        [
            95,
            146
        ],
        [
            95,
            144
        ],
        [
            94,
            143
        ],
        [
            94,
            142
        ],
        [
            92,
            140
        ],
        [
            92,
            138
        ],
        [
            91,
            137
        ],
        [
            91,
            136
        ],
        [
            90,
            135
        ],
        [
            90,
            133
        ],
        [
            89,
            132
        ],
        [
            89,
            129
        ],
        [
            88,
            128
        ],
        [
            88,
            122
        ],
        [
            87,
            121
        ],
        [
            87,
            119
        ],
        [
            86,
            118
        ],
        [
            86,
            115
        ],
        [
            85,
            114
        ],
        [
            85,
            112
        ],
        [
            84,
            111
        ],
        [
            84,
            101
        ],
        [
            85,
            100
        ],
        [
            85,
            98
        ],
        [
            88,
            95
        ],
        [
            88,
            93
        ],
        [
            89,
            92
        ],
        [
            90,
            92
        ],
        [
            92,
            90
        ],
        [
            93,
            90
        ],
        [
            95,
            88
        ],
        [
            95,
            85
        ],
        [
            96,
            84
        ],
        [
            96,
            81
        ],
        [
            97,
            80
        ],
        [
            97,
            68
        ],
        [
            96,
            67
        ],
        [
            96,
            60
        ],
        [
            95,
            59
        ],
        [
            95,
            56
        ],
        [
            94,
            55
        ],
        [
            94,
            53
        ],
        [
            93,
            52
        ],
        [
            93,
            50
        ],
        [
            92,
            49
        ],
        [
            92,
            48
        ],
        [
            90,
            46
        ],
        [
            90,
            45
        ],
        [
            89,
            44
        ],
        [
            89,
            43
        ],
        [
            88,
            43
        ],
        [
            87,
            42
        ],
        [
            86,
            42
        ],
        [
            85,
            41
        ],
        [
            85,
            40
        ],
        [
            84,
            39
        ],
        [
            84,
            38
        ],
        [
            83,
            37
        ],
        [
            82,
            37
        ],
        [
            79,
            34
        ],
        [
            79,
            32
        ],
        [
            78,
            31
        ],
        [
            78,
            30
        ],
        [
            77,
            29
        ],
        [
            77,
            27
        ],
        [
            76,
            26
        ],
        [
            76,
            25
        ],
        [
            75,
            24
        ],
        [
            75,
            23
        ],
        [
            74,
            22
        ],
        [
            74,
            21
        ],
        [
            73,
            20
        ],
        [
            72,
            20
        ],
        [
            70,
            18
        ],
        [
            70,
            17
        ],
        [
            69,
            16
        ]
    ],)

    frame = np.zeros((480, 720))

    rot_angle, area, width, height, center_point, corner_points = label_utils.min_bounding_rect(points)

    print(rot_angle, area, width, height, center_point, corner_points)

    angle, width, height, center = label_utils.ellipse_bbox(points)

    print(angle, width, height, center)

    img_utils.draw_dot(frame, center[1], center[0], radius=7, color=(255, 255, 0))

    for point in corner_points:
        img_utils.draw_dot(frame, point[1], point[0], radius=5, color=(255, 255, 0))

    for point in points:
        img_utils.draw_dot(frame, point[1], point[0], radius=2, color=(255, 255, 0))

    cv2.ellipse(frame, (center[1], center[0]), (int(height), int(width)), -angle, 0, 360, (255, 255, 0), 1)

    cv2.imshow("ellipse test", frame.astype(np.uint8))
    cv2.waitKey(0)
